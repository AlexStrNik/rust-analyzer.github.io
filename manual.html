<!DOCTYPE html>
<html lang="en-US">

<head>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>User Manual</title>
  <meta name="description"
    content="rust-analyzer: building a better Rust IDE">

  <link rel="stylesheet" href="/css/asciidoctor.css">
  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://rust-analyzer.github.io//manual.html">
  <link rel="alternate" type="application/rss+xml" title="rust-analyzer"
    href="https://rust-analyzer.github.io//feed.xml">

  <link rel="apple-touch-icon" sizes="180x180" href="/assets/fav/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/assets/fav/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/assets/fav/favicon-16x16.png">
  <link rel="manifest" href="/assets/site.webmanifest">
  <link rel="mask-icon" href="/assets/fav/safari-pinned-tab.svg" color="#5bbad5">
  <meta name="msapplication-TileColor" content="#ffc40d">
  <meta name="theme-color" content="#ffffff">
</head>

<body>
  
  <header>
    <div id="header-inner">
      <a class="site-title" href="/">
        <img src="/assets/rust-analyzer.svg" alt="rust analyzer" id="header-logo">
      </a>
      <a class="nav-link" href="https://opencollective.com/rust-analyzer/">Sponsor</a>
      <a class="nav-link" href="/manual.html">Docs</a>
      <a class="nav-link" href="/blog">Blog</a>
      <a class="nav-link" href="/thisweek">Changelog</a>
    </div>
  </header>
  

  <main>
    <article>
<h1>User Manual</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>At its core, rust-analyzer is a <strong>library</strong> for semantic analysis of Rust code as it changes over time.
This manual focuses on a specific usage of the library&#8201;&#8212;&#8201;the implementation of
<a href="https://microsoft.github.io/language-server-protocol/">Language Server Protocol</a>.
LSP allows various code editors, like VS Code, Emacs or Vim, to implement semantic features like completion or goto definition by talking to an external language server process.</p>
</div>
<div class="paragraph">
<p>To improve this document, send a pull request against
<a href="https://github.com/rust-analyzer/rust-analyzer/blob/master/docs/user/readme.adoc">this file</a>.</p>
</div>
</div>
<div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#installation">Installation</a>
<ul class="sectlevel2">
<li><a href="#vs-code">VS Code</a></li>
<li><a href="#language-server-binary">Language Server Binary</a></li>
<li><a href="#emacs">Emacs</a></li>
<li><a href="#vim">Vim</a></li>
<li><a href="#sublime-text-3">Sublime Text 3</a></li>
</ul>
</li>
<li><a href="#usage">Usage</a></li>
</ul>
</div>
</div>
<div class="sect1">
<h2 id="installation"><a class="anchor" href="#installation"></a>Installation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In theory, one should be able to just install the server binary and have it automatically work with any editor.
We are not there yet, so some editor specific setup is required.</p>
</div>
<div class="paragraph">
<p>Additionally, rust-analyzer needs sources of the standard library.
If the source code is not present, rust-analyzer will attempt to install it automatically.</p>
</div>
<div class="paragraph">
<p>To add the sources manually, run the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">$ rustup component add rust-src</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="vs-code"><a class="anchor" href="#vs-code"></a>VS Code</h3>
<div class="paragraph">
<p>This is the best supported editor at the moment.
rust-analyzer plugin for VS Code is maintained
<a href="https://github.com/rust-analyzer/rust-analyzer/tree/master/editors/code">in tree</a>.</p>
</div>
<div class="paragraph">
<p>You can install the latest release of the plugin from
<a href="https://marketplace.visualstudio.com/items?itemName=matklad.rust-analyzer">the marketplace</a>.
By default, the plugin will prompt you to download the matching version of the server as well:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="https://user-images.githubusercontent.com/9021944/75067008-17502500-54ba-11ea-835a-f92aac50e866.png" alt="75067008 17502500 54ba 11ea 835a f92aac50e866">
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">:information_source:</div>
</td>
<td class="content">
<div class="paragraph">
<p>To disable this notification put the following to <code>settings.json</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{ "rust-analyzer.updates.askBeforeDownload": false }</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The server binary is stored in <code>~/.config/Code/User/globalStorage/matklad.rust-analyzer</code>.</p>
</div>
<div class="paragraph">
<p>Note that we only support the latest version of VS Code.</p>
</div>
<div class="sect3">
<h4 id="updates"><a class="anchor" href="#updates"></a>Updates</h4>
<div class="paragraph">
<p>The extension will be updated automatically as new versions become available. It will ask your permission to download the matching language server version binary if needed.</p>
</div>
<div class="sect4">
<h5 id="nightly"><a class="anchor" href="#nightly"></a>Nightly</h5>
<div class="paragraph">
<p>We ship nightly releases for VS Code. To help us out with testing the newest code and follow the bleeding edge of our <code>master</code>, please use the following config:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{ "rust-analyzer.updates.channel": "nightly" }</code></pre>
</div>
</div>
<div class="paragraph">
<p>You will be prompted to install the <code>nightly</code> extension version. Just click <code>Download now</code> and from that moment you will get automatic updates each 24 hours.</p>
</div>
<div class="paragraph">
<p>If you don&#8217;t want to be asked for <code>Download now</code> every day when the new nightly version is released add the following to your <code>settings.json</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{ "rust-analyzer.updates.askBeforeDownload": false }</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">:information_source:</div>
</td>
<td class="content">
Nightly extension should <strong>only</strong> be installed via the <code>Download now</code> action from VS Code.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="building-from-source"><a class="anchor" href="#building-from-source"></a>Building From Source</h4>
<div class="paragraph">
<p>Alternatively, both the server and the plugin can be installed from source:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>$ git clone https://github.com/rust-analyzer/rust-analyzer.git &amp;&amp; cd rust-analyzer
$ cargo xtask install</code></pre>
</div>
</div>
<div class="paragraph">
<p>You&#8217;ll need Cargo, nodejs and npm for this.
To make VS Code use the freshly built server, add this to the settings:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{ "rust-analyzer.serverPath": "rust-analyzer" }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that installing via <code>xtask install</code> does not work for VS Code Remote, instead you&#8217;ll need to install the <code>.vsix</code> manually.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="language-server-binary"><a class="anchor" href="#language-server-binary"></a>Language Server Binary</h3>
<div class="paragraph">
<p>Other editors generally require <code>rust-analyzer</code> binary to be in <code>$PATH</code>.
You can download the pre-built binary from
<a href="https://github.com/rust-analyzer/rust-analyzer/releases">releases</a>
page, or you can install it from source using the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">$ cargo xtask install --server</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="emacs"><a class="anchor" href="#emacs"></a>Emacs</h3>
<div class="paragraph">
<p>Emacs support is maintained <a href="https://github.com/emacs-lsp/lsp-mode/blob/master/lsp-rust.el">upstream</a>.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Install the most recent version of <code>emacs-lsp</code> package by following the instructions <a href="https://github.com/emacs-lsp/lsp-mode">here</a>.</p>
</li>
<li>
<p>Set <code>lsp-rust-server</code> to <code>'rust-analyzer</code>.</p>
</li>
<li>
<p>Run <code>lsp</code> in a Rust buffer.</p>
</li>
<li>
<p>(Optionally) bind commands like <code>lsp-rust-analyzer-join-lines</code>, <code>lsp-extend-selection</code> and <code>lsp-rust-analyzer-expand-macro</code> to keys.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="vim"><a class="anchor" href="#vim"></a>Vim</h3>
<div class="paragraph">
<p>The are several LSP client implementations for vim:</p>
</div>
<div class="sect3">
<h4 id="coc-rust-analyzer"><a class="anchor" href="#coc-rust-analyzer"></a>coc-rust-analyzer</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Install coc.nvim by following the instructions at
<a href="https://github.com/neoclide/coc.nvim">coc.nvim</a>
(nodejs required)</p>
</li>
<li>
<p>Run <code>:CocInstall coc-rust-analyzer</code> to install
<a href="https://github.com/fannheyward/coc-rust-analyzer">coc-rust-analyzer</a>,
this extension implements <em>most</em> of the features supported in the VSCode extension:</p>
<div class="ulist">
<ul>
<li>
<p>same configurations as VSCode extension, <code>rust-analyzer.serverPath</code>, <code>rust-analyzer.enableCargoWatchOnStartup</code> etc.</p>
</li>
<li>
<p>same commands too, <code>rust-analyzer.analyzerStatus</code>, <code>rust-analyzer.startCargoWatch</code> etc.</p>
</li>
<li>
<p>highlighting and inlay_hints are not implemented yet</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="languageclient-neovim"><a class="anchor" href="#languageclient-neovim"></a>LanguageClient-neovim</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Install LanguageClient-neovim by following the instructions
<a href="https://github.com/autozimu/LanguageClient-neovim">here</a></p>
<div class="ulist">
<ul>
<li>
<p>The github project wiki has extra tips on configuration</p>
</li>
</ul>
</div>
</li>
<li>
<p>Configure by adding this to your vim/neovim config file (replacing the existing Rust-specific line if it exists):</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vim" data-lang="vim">let g:LanguageClient_serverCommands = {
\ 'rust': ['rust-analyzer'],
\ }</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="nvim-lsp"><a class="anchor" href="#nvim-lsp"></a>nvim-lsp</h4>
<div class="paragraph">
<p>NeoVim 0.5 (not yet released) has built-in language server support.
For a quick start configuration of rust-analyzer, use <a href="https://github.com/neovim/nvim-lsp#rust_analyzer">neovim/nvim-lsp</a>.
Once <code>neovim/nvim-lsp</code> is installed, use <code>lua require'nvim_lsp'.rust_analyzer.setup({})</code> in your <code>init.vim</code>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sublime-text-3"><a class="anchor" href="#sublime-text-3"></a>Sublime Text 3</h3>
<div class="paragraph">
<p>Prerequisites:</p>
</div>
<div class="paragraph">
<p><code>LSP</code> package.</p>
</div>
<div class="paragraph">
<p>Installation:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke the command palette with &lt;kbd&gt;Ctrl+Shift+P&lt;/kbd&gt;</p>
</li>
<li>
<p>Type <code>LSP Settings</code> to open the LSP preferences editor</p>
</li>
<li>
<p>Add the following LSP client definition to your settings:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">"rust-analyzer": {
    "command": ["rust-analyzer"],
    "languageId": "rust",
    "scopes": ["source.rust"],
    "syntaxes": [
        "Packages/Rust/Rust.sublime-syntax",
        "Packages/Rust Enhanced/RustEnhanced.sublime-syntax"
    ],
    "initializationOptions": {
      "featureFlags": {
      }
    },
}</code></pre>
</div>
</div>
</li>
<li>
<p>You can now invoke the command palette and type LSP enable to locally/globally enable the rust-analyzer LSP (type LSP enable, then choose either locally or globally, then select rust-analyzer)</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="usage"><a class="anchor" href="#usage"></a>Usage</h2>
<div class="sectionbody">
<div class="paragraph">
<p>See <a href="https://github.com/rust-analyzer/rust-analyzer/blob/master/docs/user/features.md">features.md</a>.</p>
</div>
</div>
</div>
</article>

  </main>

  <footer>
    <p>
      <a href="/feed.xml" class="footer-link">
        <i class="fa fa-rss"></i> rss
      </a>
      <a href="https://github.com/rust-analyzer/rust-analyzer.github.io" class="footer-link">
        <i class="fa fa-github"></i> src
      </a>
      <a href="https://opencollective.com/rust-analyzer/" class="footer-link">
        <i class="fa fa-github"></i> sponsor
      </a>
    </p>
  </footer>
</body>

</html>
